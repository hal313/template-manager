!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("flat")):"function"==typeof define&&define.amd?define(["exports","flat"],n):n(e.TemplateManager={},e.flat)}(this,function(e,n){"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")},r=function(e){return!!e&&e.hasOwnProperty("pattern")&&e.hasOwnProperty("replacement")},c=function e(){u(this,e)};c.forEach=function(n,t){Array.isArray(n)?n.forEach(t):Object.getOwnPropertyNames(n).forEach(function(e){t(n[e],e)})},c.isFunction=function(e){return"function"==typeof e},c.flattenMap=function(e){return n.flatten(JSON.parse(JSON.stringify(e)))},c.merge=function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];var r={},i=void 0,o=void 0;if(n){i=Array.prototype.slice.call(n);for(var a=0;a<i.length;a++)if(o=i[a])for(var f in o)r[f]=o[f]}return r},c.isDefined=function(e){return null!=e},c.isNil=function(e){return!c.isDefined(e)||c.isDefined(e)&&""===e.toString().trim()},c.createResolverDefinition=function(e,n){if("string"!=typeof e)throw new Error("'pattern' must be a string, not '"+(void 0===e?"undefined":t(e))+"' ('"+e+"'); this error may occur if using an incomplete classic resolver definition - be sure all classic resolver definitions have both a 'pattern' and 'replacement'.");return{pattern:e,replacement:n}},c.normalizeResolverDefinition=function(e,n){return r(e)?c.createResolverDefinition(e.pattern,e.replacement):c.createResolverDefinition(e,n)},c.normalizeResolverDefinitions=function(e){var t=[];return e&&c.forEach(e,function(e,n){r(e)?t.push(c.normalizeResolverDefinition(e)):t.push(c.normalizeResolverDefinition(n,e))}),t},c.version="2.0.0";var f=function e(n,t){return c.isFunction(n)?e(n(t)):n},s=function(i,e,o){var a=i;return c.forEach(e,function(e){var n,t=(n=e.pattern,new RegExp("\\${"+n+"}","gi")),r=void 0;r=c.isFunction(e.replacement)?e.replacement(e.pattern,i,a):e.replacement,a=void 0===r?a.replace(t,f(o.undefinedReplacement,e.pattern)):null===r?a.replace(t,f(o.nullReplacement,e.pattern)):a.replace(t,r)}),a},l=function e(n,t){u(this,e);var o=c.normalizeResolverDefinitions(n),a=c.merge({nullReplacement:e.identityResolver,undefinedReplacement:e.identityResolver},t);this.resolve=function(e,n){var t=e,r=void 0,i=[];if(!c.isDefined(e))return e;if(o&&c.forEach(o,function(e){i.push(e)}),n&&c.forEach(c.normalizeResolverDefinitions(n),function(e){i.push(e)}),i.length)for(;t!==(r=s(t,i,a));)t=r;return t}};l.identityResolver=function(e){return"${"+e+"}"};var p=function(e){if(c.isNil(e))throw new Error("Invalid template name: '"+e+"'/");return e},i=function e(r,n){var i=this;u(this,e);var a=c.merge({scriptType:"text/x-template-manager"},n),o={},f=function(e,n){o[p(e)]=n};this.get=function(e){var n=function(e){if(!i.hasTemplate(p(e)))throw new Error("Template '"+e+"' does not exist");return o[e]}(p(e));return{process:function(e){var t=[];return r&&c.forEach(r,function(e,n){t.push(c.normalizeResolverDefinition(e,n))}),e&&c.forEach(e,function(e,n){t.push(c.normalizeResolverDefinition(e,n))}),(new l).resolve(n,t)},raw:function(){return n}}},this.add=function(e,n){var t=p(e);if(i.hasTemplate(t))throw new Error("Duplicate template name '"+e+"'");if(!c.isDefined(n))throw new Error("Template must be defined");return f(t,n),i.get(t)},this.load=function(e){var n=(e||document).getElementsByTagName("script");c.forEach(n,function(e,n){var t,r,i=void 0,o=void 0;a.scriptType===e.type&&(r="name",i=(t=e).getAttribute(r)||t.getAttribute("data-"+r),o=e.innerHTML.trim(),p(i),f(i,o))})},this.remove=function(e){delete o[p(e)]},this.getTemplateNames=function(){var t=[];return c.forEach(o,function(e,n){t.push(n)}),t},this.hasTemplate=function(e){return c.isDefined(o[p(e)])},this.empty=function(){o={}}};i.version=l.version="2.0.0",e.StringResolver=l,e.TemplateManager=i,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=TemplateManager.min.js.map