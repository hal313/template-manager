!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("flat")):"function"==typeof define&&define.amd?define(["exports","flat"],n):n(e.TemplateManager={},e.flat)}(this,function(e,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")},r=function(e){return!!e&&e.hasOwnProperty("pattern")&&e.hasOwnProperty("replacement")},u=function e(){c(this,e)};u.forEach=function(n,t){Array.isArray(n)?n.forEach(t):Object.getOwnPropertyNames(n).forEach(function(e){t(n[e],e)})},u.flattenMap=function(e){return n.flatten(JSON.parse(JSON.stringify(e)))},u.merge=function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];for(var r={},i=Array.prototype.slice.call(n),o=void 0,a=0;a<i.length;a++)if(o=i[a])for(var f in o)r[f]=o[f];return r},u.isDefined=function(e){return null!=e},u.isNil=function(e){return!u.isDefined(e)||u.isDefined(e)&&""===e.toString().trim()},u.isFunction=function(e){return"function"==typeof e},u.isArray=function(e){return Array.isArray(e)},u.isObject=function(e){return u.isDefined(e)&&!u.isArray(e)&&"object"===(void 0===e?"undefined":i(e))},u.createResolverDefinition=function(e,n){if("string"!=typeof e)throw new Error("'pattern' must be a string, not '"+(void 0===e?"undefined":i(e))+"' ('"+e+"'); this error may occur if using an incomplete classic resolver definition - be sure all classic resolver definitions have both a 'pattern' and 'replacement'.");if(u.isArray(n)||u.isObject(n)){var t=[],r={};return r[e]=n,u.forEach(u.flattenMap(r),function(e,n){t.push({pattern:n,replacement:e})}),t}return[{pattern:e,replacement:n}]},u.normalizeResolverDefinition=function(e,n){return r(e)?u.createResolverDefinition(e.pattern,e.replacement):u.createResolverDefinition(e,n)},u.normalizeResolverDefinitions=function(e){var t=[];return e&&u.forEach(e,function(e,n){t=r(e)?t.concat(u.normalizeResolverDefinition(e,void 0)):t.concat(u.normalizeResolverDefinition(n,e))}),t},u.version="2.1.3";var f=function e(n,t){return u.isFunction(n)?e(n(t)):n},s=function(i,e,o){var a=i;return u.forEach(e,function(e){var n,t=(n=e.pattern,new RegExp("\\${"+n+"}","gi")),r=void 0;r=u.isFunction(e.replacement)?e.replacement(e.pattern,i,a):e.replacement,a=void 0===r?a.replace(t,f(o.undefinedReplacement,e.pattern)):null===r?a.replace(t,f(o.nullReplacement,e.pattern)):a.replace(t,r)}),a},l=function e(n,t){c(this,e);var o=u.normalizeResolverDefinitions(n),a=u.merge({nullReplacement:e.identityResolver,undefinedReplacement:e.identityResolver},t);this.resolve=function(e,n){var t=e,r=void 0,i=[];if(!u.isDefined(e))return e;if(o.length&&u.forEach(o,function(e){i.push(e)}),n&&u.forEach(u.normalizeResolverDefinitions(n),function(e){i.push(e)}),i.length)for(;t!==(r=s(t,i,a));)t=r;return t}};l.identityResolver=function(e){return"${"+e+"}"};var p=function(e){if(u.isNil(e))throw new Error("Invalid template name: '"+e+"'/");return e},t=function e(r,n){var i=this;c(this,e);var a=u.merge({scriptType:"text/x-template-manager"},n),o={},f=function(e,n){o[p(e)]=n};this.get=function(e){var n=function(e){if(!i.hasTemplate(p(e)))throw new Error("Template '"+e+"' does not exist");return o[e]}(p(e));return{process:function(e){var t=[];return r&&u.forEach(r,function(e,n){t=t.concat(u.normalizeResolverDefinition(e,n))}),e&&u.forEach(e,function(e,n){t=t.concat(u.normalizeResolverDefinition(e,n))}),(new l).resolve(n,t)},raw:function(){return n}}},this.add=function(e,n){var t=p(e);if(i.hasTemplate(t))throw new Error("Duplicate template name '"+e+"'");if(!u.isDefined(n))throw new Error("Template must be defined");return f(t,n),i.get(t)},this.load=function(e){var n=(e||document).getElementsByTagName("script");u.forEach(n,function(e,n){var t,r,i=void 0,o=void 0;a.scriptType===e.type&&(r="name",i=(t=e).getAttribute(r)||t.getAttribute("data-"+r),o=e.innerHTML.trim(),p(i),f(i,o))})},this.remove=function(e){delete o[p(e)]},this.getTemplateNames=function(){var t=[];return u.forEach(o,function(e,n){t.push(n)}),t},this.hasTemplate=function(e){return u.isDefined(o[p(e)])},this.empty=function(){o={}}};t.version=l.version="2.1.3",e.StringResolver=l,e.TemplateManager=t,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=TemplateManager.min.js.map